group_by(tension,site,unique) %>%
dplyr::mutate(total = sum(peaks_count))->
fticr_pore_unique_peaks
# summarizing by groups
fticr_pore_unique2 %>%
dplyr::group_by(tension,site, unique,Class) %>%
dplyr::summarize(peaks_count = n()) ->
dplyr::group_by(tension,site,unique) %>%
dplyr::mutate(total = sum(peaks_count))->
fticr_pore_unique_peaks
# summarizing by groups
fticr_pore_unique2 %>%
dplyr::group_by(tension,site, unique,Class) %>%
dplyr::summarize(peaks_count = n()) ->
fticr_pore_unique_peaks
View(fticr_pore_unique_peaks)
# summarizing by groups
fticr_pore_unique2 %>%
dplyr::group_by(tension,site, unique,Class) %>%
dplyr::summarize(peaks_count = n()) ->
group_by(tension) %>%
dplyr::mutate(total = sum(peaks_count))->
fticr_pore_unique_peaks
# summarizing by groups
fticr_pore_unique2 %>%
dplyr::group_by(tension,site, unique,Class) %>%
dplyr::summarize(peaks_count = n())  %>%
group_by(tension,site,unique) %>%
dplyr::mutate(total = sum(peaks_count))->
fticr_pore_unique_peaks
fticr_pore_unique_peaks %>%
spread(Class,peaks_count) %>% # first, convert into wide-form, so each group is a column
dplyr::select(-total,total) %>% # move total to the end
gather(Class,peaks_count,AminoSugar:total)-> # combine all the groups+total into a single column
fticr_pore_unique_peaks2
View(fticr_pore_unique_peaks2)
View(fticr_pore_unique_peaks)
# summarizing by groups
fticr_pore_unique2 %>%
dplyr::group_by(tension,site, unique,Class) %>%
dplyr::summarize(peaks_count = n())  %>%
group_by(tension,site,unique) %>%
dplyr::mutate(total = sum(peaks_count))->
fticr_pore_unique_peaks
fticr_pore_unique_peaks %>%
spread(Class,peaks_count) %>% # first, convert into wide-form, so each group is a column
dplyr::select(-total,total) %>% # move total to the end
gather(Class,peaks_count,AminoSugar:total)-> # combine all the groups+total into a single column
fticr_pore_unique_peaks2
fticr_pore_unique_peaks2 = fticr_pore_unique_peaks2[complete.cases(fticr_pore_unique_peaks2),]
### OUTPUT
write_csv(fticr_pore_unique_peaks2,FTICR_PORE_UNIQUE_PEAKS)
pore_unique_peaks = read.csv(FTICR_PORE_UNIQUE_PEAKS)# <- "fticr/fticr_pore_unique_peakscount.csv"
old.lvl = levels(factor(pore_unique_peaks$Class))
pore_unique_peaks$Class = factor(pore_unique_peaks$Class,
levels=c(sort(old.lvl[old.lvl!="total"]), "total"))
soil_unique_peaks%>%
ungroup %>%
dplyr::mutate(sp = paste(unique),
val = paste(peaks_count)) %>%
select(site, Class,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r")
old.lvl = levels(factor(pore_unique_peaks$Class))
pore_unique_peaks$Class = factor(pore_unique_peaks$Class,
levels=c(sort(old.lvl[old.lvl!="total"]), "total"))
soil_unique_peaks%>%
ungroup %>%
filter(tension=="50 kPa") %>%
dplyr::mutate(sp = paste(unique),
val = paste(peaks_count)) %>%
select(site, Class,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r")
pore_unique_peaks%>%
ungroup %>%
filter(tension=="50 kPa") %>%
dplyr::mutate(sp = paste(unique),
val = paste(peaks_count)) %>%
select(site, Class,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r")
old.lvl = levels(factor(pore_unique_peaks$Class))
pore_unique_peaks$Class = factor(pore_unique_peaks$Class,
levels=c(sort(old.lvl[old.lvl!="total"]), "total"))
pore_unique_peaks%>%
ungroup %>%
filter(tension=="50 kPa") %>%
dplyr::mutate(sp = paste(site,unique),
val = paste(peaks_count)) %>%
select(Class,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r")
pore_unique_peaks%>%
ungroup %>%
filter(tension=="1.5 kPa") %>%
dplyr::mutate(sp = paste(site,unique),
val = paste(peaks_count)) %>%
select(Class,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r")
pore_unique_peaks%>%
ungroup %>%
filter(tension=="1.5 kPa") %>%
dplyr::mutate(sp = paste(site,unique),
val = paste(peaks_count)) %>%
select(Class,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r", na="")
soil_character = read_excel("data/soil_character.xlsx")
names(soil_character)
#converting variables to numeric form
soil_character$K_meq100g = soil_character$`K_ppm`/390
soil_character$`NO3-N_ppm` = as.numeric(soil_character$`NO3-N_ppm`)
soil_character$Ca_meq100g = as.numeric(soil_character$Ca_meq100g)
soil_character$Mg_meq100g = as.numeric(soil_character$Mg_meq100g)
soil_character$`pH` = as.numeric(soil_character$`pH`)
soil_character$EC_dS_m = as.numeric(soil_character$EC_dS_m)
soil_character$`Sand_perc` = as.numeric(soil_character$`Sand_perc`)
soil_character$`Silt_perc` = as.numeric(soil_character$`Silt_perc`)
soil_character$`Clay_perc` = as.numeric(soil_character$`Clay_perc`)
View(soil_character)
names(soil_character)
soil_character %>%
select(TC_perc, TN_perc, TOC_perc, WSOC_mg_g,
Ca_meq100g, Mg_meq100g,
pH, EC_dS_m,
Sand_perc, Silt_perc, Clay_perc)->
soil_character2
View(soil_character2)
soil_character %>%
select(soil,
TC_perc, TN_perc, TOC_perc, WSOC_mg_g,
Ca_meq100g, Mg_meq100g,
pH, EC_dS_m,
Sand_perc, Silt_perc, Clay_perc)->
soil_character2
soil_character %>%
dplyr::rename(site=Soil) %>%
select(site,
TC_perc, TN_perc, TOC_perc, WSOC_mg_g,
Ca_meq100g, Mg_meq100g,
pH, EC_dS_m,
Sand_perc, Silt_perc, Clay_perc)->
soil_character2
# gather
soil_character2 %>%
gather(variable, value, 2:12)->
soil_character2_long
View(soil_character2_long)
# gather
soil_character2 %>%
gather(variable, value, 2:12) %>%
mutate(value = round(value,3))->
soil_character2_long
# gather
soil_character2 %>%
gather(variable, value, 2:12) %>%
mutate(value = round(value,2))->
soil_character2_long
soil_character2_long %>%
group_by(site, variable) %>%
dplyr::summarise(se = sd(value)/sqrt(n()))->
soil_character_summary
View(soil_character_summary)
soil_character2_long %>%
group_by(site, variable) %>%
dplyr::summarise(sd = sd(value),
n = n(),
se = sd(value)/sqrt(n()))->
soil_character_summary
# gather
soil_character2 %>%
gather(variable, value, 2:12) %>%
mutate(value = round(value,2)) %>%
drop_na()->
soil_character2_long
soil_character2_long %>%
group_by(site, variable) %>%
dplyr::summarise(sd = sd(value),
n = n(),
se = sd(value)/sqrt(n()))->
soil_character_summary
soil_character2_long %>%
group_by(site, variable) %>%
dplyr::summarise(mean = mean(value),
sd = sd(value),
n = n(),
se = sd(value)/sqrt(n()))->
soil_character_summary
soil_character2_long %>%
group_by(site, variable) %>%
dplyr::summarise(mean = mean(value),
se = sd(value)/sqrt(n())) %>%
dplyr::mutate(summary = paste(round(mean,2), "\u00B1",round(se,2)))->
soil_character_summary
# gather
soil_character2 %>%
gather(variable, value, 2:12) %>%
mutate(value = round(value,2)) %>%
mutate(variable = factor(variable, levels = c("TC_perc", "TN_perc", "TOC_perc", "WSOC_mg_g",
"Ca_meq100g", "Mg_meq100g",
"pH", "EC_dS_m",
"Sand_perc", "Silt_perc", "Clay_perc"))) %>%
drop_na()->
soil_character2_long
soil_character2_long %>%
group_by(site, variable) %>%
dplyr::summarise(mean = mean(value),
se = sd(value)/sqrt(n())) %>%
dplyr::mutate(summary = paste(round(mean,2), "\u00B1",round(se,2)))->
soil_character_summary
a <-aov(value ~ site, data = soil_character2_long)
h <-HSD.test(a,"site")
h
tibble(`SR` = h$groups["SR",2],
`CCPRW` = h$groups["CPCRW",2],
`DWP` = h$groups["DWP",2])
soil_character2_long %>%
group_by(variable) %>%
do(fit_hsd(.))  ->
soil_charac_hsd
fit_hsd <- function(dat) {
a <-aov(value ~ site, data = dat)
h <-HSD.test(a,"site")
#create a tibble with one column for each treatment
#the hsd results are row1 = drought, row2 = saturation, row3 = time zero saturation, row4 = field moist. hsd letters are in column 2
tibble(`SR` = h$groups["SR",2],
`CCPRW` = h$groups["CPCRW",2],
`DWP` = h$groups["DWP",2])
}
soil_character2_long %>%
group_by(variable) %>%
do(fit_hsd(.))  ->
soil_charac_hsd
View(soil_charac_hsd)
fit_hsd <- function(dat) {
a <-aov(value ~ site, data = dat)
h <-HSD.test(a,"site")
#create a tibble with one column for each treatment
#the hsd results are row1 = drought, row2 = saturation, row3 = time zero saturation, row4 = field moist. hsd letters are in column 2
tibble(`SR` = h$groups["SR",2],
`CPCRW` = h$groups["CPCRW",2],
`DWP` = h$groups["DWP",2])
}
soil_character2_long %>%
group_by(variable) %>%
do(fit_hsd(.))  ->
soil_charac_hsd
soil_charac_hsd %>%
gather(treatment, hsd, 2:4)-> #gather columns 4-7 (treatment levels)
soil_charac_hsd2
# merge `summary` and `hsd`
soil_character_summary2 = merge(soil_character_summary, soil_charac_hsd2, by = "site, variable")
# merge `summary` and `hsd`
soil_character_summary2 = merge(soil_character_summary, soil_charac_hsd2, by = c("site, variable"))
View(soil_character_summary)
View(soil_charac_hsd2)
soil_charac_hsd %>%
gather(site, hsd, 2:4)-> #gather columns 4-7 (treatment levels)
soil_charac_hsd2
# merge `summary` and `hsd`
soil_character_summary2 = merge(soil_character_summary, soil_charac_hsd2, by = c("site, variable"))
soil_character2_long %>%
group_by(site, variable) %>%
dplyr::summarise(mean = mean(value),
se = sd(value)/sqrt(n())) %>%
dplyr::mutate(summary = paste(round(mean,2), "\u00B1",round(se,2)))->
soil_character_summary
fit_hsd <- function(dat) {
a <-aov(value ~ site, data = dat)
h <-HSD.test(a,"site")
#create a tibble with one column for each treatment
#the hsd results are row1 = drought, row2 = saturation, row3 = time zero saturation, row4 = field moist. hsd letters are in column 2
tibble(`SR` = h$groups["SR",2],
`CPCRW` = h$groups["CPCRW",2],
`DWP` = h$groups["DWP",2])
}
soil_character2_long %>%
group_by(variable) %>%
do(fit_hsd(.))  ->
soil_charac_hsd
soil_charac_hsd %>%
gather(site, hsd, 2:4)-> #gather columns 4-7 (treatment levels)
soil_charac_hsd2
# merge `summary` and `hsd`
soil_character_summary2 = merge(soil_character_summary, soil_charac_hsd2, by = c("site, variable"))
# merge `summary` and `hsd`
soil_character_summary2 = merge(soil_character_summary, soil_charac_hsd2, by = c("site", "variable"))
View(soil_character_summary2)
soil_character_summary2 %>%
mutate(summary_hsd = paste(summary," ",hsd))->
soil_character_summary2
soil_character_summary2 %>%
mutate(summary_hsd = paste(summary," ",hsd))->
soil_character_summary2 %>%
select(-hsd)->
soil_character_summary2
soil_character_summary2 %>%
mutate(summary_hsd = paste(summary," ",hsd)) %>%
select(-hsd)->
soil_character_summary2
## CREATE OUTPUT FILES
# CHARACTERIZATION
CHARACTERIZATION <- "processed/soil_characterization.csv"
### OUTPUT
write.csv(soil_character_summary2, CHARACTERIZATION)
# input files
#   CHARAC
charac = read.csv(CHARACTERIZATION)# <- "processed/soil_characterization.csv"
charac %>%
ungroup %>%
dplyr::mutate(sp = paste(site),
val = paste(summary_hsd)) %>%
select(variable,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r")
charac %>%
mutate(variable = factor(variable, levels = c("TC_perc", "TN_perc", "TOC_perc", "WSOC_mg_g",
"Ca_meq100g", "Mg_meq100g",
"pH", "EC_dS_m",
"Sand_perc", "Silt_perc", "Clay_perc"))) %>%
ungroup %>%
dplyr::mutate(sp = paste(site),
val = paste(summary_hsd)) %>%
select(variable,sp, val) %>%
spread(sp, val) %>%
knitr::kable(align = "r")
PORE_DISTRIBUTION <- "processed/pore_distribution.csv"
pores = read_excel("data/pore_size.xlsx")
names(pores)
#creating frequency distribution tables for each site
cpcrw_pore_scores = pores$CPCRW
dwp_pore_scores = pores$DWP
sr_pore_scores = pores$SR
bins = seq(0,4000, by = 50)
cpcrw_scores = cut(cpcrw_pore_scores,bins)
dwp_scores = cut(dwp_pore_scores,bins)
sr_scores = cut(sr_pore_scores,bins)
freq_cpcrw = transform(table(cpcrw_scores))
c = transform(freq_cpcrw,Cum_Freq=cumsum(Freq),Perc_Freq = prop.table(Freq)*100)
c$scores = seq(50,4000,by = 50)
freq_dwp = transform(table(dwp_scores))
d = transform(freq_dwp,Cum_Freq=cumsum(Freq),Perc_Freq = prop.table(Freq)*100)
d$scores = seq(50,4000,by = 50)
freq_sr = transform(table(sr_scores))
s = transform(freq_sr,Cum_Freq=cumsum(Freq),Perc_Freq = prop.table(Freq)*100)
s$scores = seq(50,4000,by = 50)
#combining the three sites, two at a time
#the file contains frequency, cum freq, and % frequency
combined_pore_freq = merge(c,d,by = "scores")
combined_pore_freq = merge(combined_pore_freq,s,by = "scores")
names(combined_pore_freq)
# extracting only the % frequency columns and saving as a new file
combined_pore_perc_freq = data.frame(combined_pore_freq$scores,
combined_pore_freq$Perc_Freq.x,
combined_pore_freq$Perc_Freq.y,
combined_pore_freq$Perc_Freq)
names(combined_pore_perc_freq) = c("pore_size","cpcrw","dwp","sr")
write.csv(combined_pore_perc_freq,"pore_size_perc_freq2.csv")
#melting the three sites into a single column
pores_melt = melt(combined_pore_perc_freq,id = "pore_size")
names(pores_melt) = c("pore_size","site","freq")
###OUTPUT
write.csv(pores_melt,PORE_DISTRIBUTION)
pore = read.csv(PORE_DISTRIBUTION)# <- "processed/pore_distribution.csv"
ggplot(pore,aes(x = pore_size, y=freq,color = site))+
geom_line(size = 1)+
#geom_density(adjust=0.5)+
labs (y = expression (bold ("distribution, %"),
x = expression (bold ("pore size" ))))+
theme_bw()+
theme_kp()
ggplot(pore,aes(x = pore_size, y=freq,color = site))+
geom_line(size = 1)+
scale_color_brewer(palette = "Set2")+
#geom_density(adjust=0.5)+
labs (y = expression (bold ("distribution, %"),
x = expression (bold ("pore size" ))))+
theme_bw()+
theme_kp()
# van genuchten plots
gg_water_retention_vg = ggplot()+
geom_line(data = water_retention,aes(x = Tension_c, y = CPCRW_water_VG, color = "CPCRW"), size=1)+
geom_line(data = water_retention,aes(x = Tension_d, y = DWP_water_VG,color = "DWP"), size=1)+
geom_line(data = water_retention,aes(x = Tension_s, y = SR_water_VG,color = "SR"), size=1)+
# geom_point(data = water_retention,aes(x = Tension_c, y = CPCRW_water_measured))+
# geom_point(data = water_retention,aes(x = Tension_d, y = DWP_water_measured))+
# geom_point(data = water_retention,aes(x = Tension_s, y = SR_water_measured))
annotate("text", label = "DWP, fine sand", x = 25, y = 0.03,size=4,fontface="bold")+
annotate("text", label = "CPCRW, silt loam", x = 75, y = 0.13,size=4,fontface="bold")+
annotate("text", label = "SR, silty clay loam", x = 55, y = 0.3,size=4,fontface="bold")+
labs (y = expression (bold ("volumetric moisture content"),
x = expression (bold ("tension, kPa" ))))+
ylim(0,0.7)+
theme_bw()+
theme (legend.position = "none")+
theme (legend.key = element_rect(size = 3))+
theme (legend.title = element_blank())+
theme (legend.text=element_text(size=12))+
theme (legend.key = element_rect(size = 2),
legend.key.size = unit(2, 'lines'))+
#  ggtitle ("water retention curves: Van Genuchten")+
theme (plot.title = element_text(hjust = 0.05,size = 14))+
theme (axis.text=element_text(size=14,face="bold",color="black"),
axis.title=element_text(size=14,face="bold",color="black")); gg_water_retention_vg
## 4. water retention curves ----
water_retention = read_excel("data/water_retention.xlsx")
names(water_retention)
attach(water_retention)
# van genuchten plots
gg_water_retention_vg = ggplot()+
geom_line(data = water_retention,aes(x = Tension_c, y = CPCRW_water_VG, color = "CPCRW"), size=1)+
geom_line(data = water_retention,aes(x = Tension_d, y = DWP_water_VG,color = "DWP"), size=1)+
geom_line(data = water_retention,aes(x = Tension_s, y = SR_water_VG,color = "SR"), size=1)+
# geom_point(data = water_retention,aes(x = Tension_c, y = CPCRW_water_measured))+
# geom_point(data = water_retention,aes(x = Tension_d, y = DWP_water_measured))+
# geom_point(data = water_retention,aes(x = Tension_s, y = SR_water_measured))
annotate("text", label = "DWP, fine sand", x = 25, y = 0.03,size=4,fontface="bold")+
annotate("text", label = "CPCRW, silt loam", x = 75, y = 0.13,size=4,fontface="bold")+
annotate("text", label = "SR, silty clay loam", x = 55, y = 0.3,size=4,fontface="bold")+
labs (y = expression (bold ("volumetric moisture content"),
x = expression (bold ("tension, kPa" ))))+
ylim(0,0.7)+
theme_bw()+
theme (legend.position = "none")+
theme (legend.key = element_rect(size = 3))+
theme (legend.title = element_blank())+
theme (legend.text=element_text(size=12))+
theme (legend.key = element_rect(size = 2),
legend.key.size = unit(2, 'lines'))+
#  ggtitle ("water retention curves: Van Genuchten")+
theme (plot.title = element_text(hjust = 0.05,size = 14))+
theme (axis.text=element_text(size=14,face="bold",color="black"),
axis.title=element_text(size=14,face="bold",color="black")); gg_water_retention_vg
View(water_retention)
water_retention = read_excel("data/water_retention.xlsx")
# van genuchten plots
ggplot()+
geom_line(data = water_retention,aes(x = Tension_c, y = CPCRW_water_VG, color = "CPCRW"), size=1)+
geom_line(data = water_retention,aes(x = Tension_d, y = DWP_water_VG,color = "DWP"), size=1)+
geom_line(data = water_retention,aes(x = Tension_s, y = SR_water_VG,color = "SR"), size=1)+
annotate("text", label = "DWP, fine sand", x = 25, y = 0.03,size=4,fontface="bold")+
annotate("text", label = "CPCRW, silt loam", x = 75, y = 0.13,size=4,fontface="bold")+
annotate("text", label = "SR, silty clay loam", x = 55, y = 0.3,size=4,fontface="bold")+
labs (y = expression (bold ("volumetric moisture content"),
x = expression (bold ("tension, kPa" ))))+
ylim(0,0.7)+
theme_bw()+
theme_kp()+
theme (legend.position = "none")
water_retention = read_excel("data/water_retention.xlsx")
# van genuchten plots
ggplot()+
geom_line(data = water_retention,aes(x = Tension_c, y = CPCRW_water_VG, color = "CPCRW"), size=1)+
geom_line(data = water_retention,aes(x = Tension_d, y = DWP_water_VG,color = "DWP"), size=1)+
geom_line(data = water_retention,aes(x = Tension_s, y = SR_water_VG,color = "SR"), size=1)+
annotate("text", label = "DWP, fine sand", x = 25, y = 0.03,size=4,fontface="bold")+
annotate("text", label = "CPCRW, silt loam", x = 75, y = 0.13,size=4,fontface="bold")+
annotate("text", label = "SR, silty clay loam", x = 55, y = 0.3,size=4,fontface="bold")+
labs (y = expression (bold ("volumetric moisture content"),
x = expression (bold ("tension, kPa" ))))+
ylim(0,0.7)+
theme_bw()+
theme_kp()+
theme (legend.position = "none")
water_retention = read_excel("data/water_retention.xlsx")
# van genuchten plots
ggplot()+
geom_line(data = water_retention,aes(x = Tension_c, y = CPCRW_water_VG, color = "CPCRW"), size=1)+
geom_line(data = water_retention,aes(x = Tension_d, y = DWP_water_VG,color = "DWP"), size=1)+
geom_line(data = water_retention,aes(x = Tension_s, y = SR_water_VG,color = "SR"), size=1)+
annotate("text", label = "DWP, fine sand", x = 25, y = 0.03,size=4,fontface="bold")+
annotate("text", label = "CPCRW, silt loam", x = 75, y = 0.13,size=4,fontface="bold")+
annotate("text", label = "SR, silty clay loam", x = 55, y = 0.3,size=4,fontface="bold")+
labs (y = expression (bold ("volumetric moisture content"),
x = expression (bold ("tension, kPa" ))))+
ylim(0,0.6)+
theme_bw()+
theme_kp()+
theme (legend.position = "none")
water_retention = read_excel("data/water_retention.xlsx")
# van genuchten plots
ggplot()+
geom_line(data = water_retention,aes(x = Tension_c, y = CPCRW_water_VG, color = "CPCRW"), size=1)+
geom_line(data = water_retention,aes(x = Tension_d, y = DWP_water_VG,color = "DWP"), size=1)+
geom_line(data = water_retention,aes(x = Tension_s, y = SR_water_VG,color = "SR"), size=1)+
annotate("text", label = "DWP, fine sand", x = 25, y = 0.03,size=4,fontface="bold")+
annotate("text", label = "CPCRW, silt loam", x = 75, y = 0.13,size=4,fontface="bold")+
annotate("text", label = "SR, silty clay loam", x = 55, y = 0.3,size=4,fontface="bold")+
labs (y = expression (bold ("volumetric moisture content"),
x = expression (bold ("tension, kPa" ))))+
xlab("kPa")+
ylim(0,0.6)+
theme_bw()+
theme_kp()+
theme (legend.position = "none")
water_retention = read_excel("data/water_retention.xlsx")
# van genuchten plots
ggplot()+
geom_line(data = water_retention,aes(x = Tension_c, y = CPCRW_water_VG, color = "CPCRW"), size=1)+
geom_line(data = water_retention,aes(x = Tension_d, y = DWP_water_VG,color = "DWP"), size=1)+
geom_line(data = water_retention,aes(x = Tension_s, y = SR_water_VG,color = "SR"), size=1)+
annotate("text", label = "DWP, fine sand", x = 25, y = 0.03,size=4,fontface="bold")+
annotate("text", label = "CPCRW, silt loam", x = 75, y = 0.13,size=4,fontface="bold")+
annotate("text", label = "SR, silty clay loam", x = 55, y = 0.3,size=4,fontface="bold")+
labs (y = expression (bold ("volumetric moisture content")),
x = expression (bold ("tension, kPa" )))+
ylim(0,0.6)+
theme_bw()+
theme_kp()+
theme (legend.position = "none")
